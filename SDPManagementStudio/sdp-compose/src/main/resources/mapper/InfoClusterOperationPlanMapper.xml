<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sunbox.sdpcompose.mapper.InfoClusterOperationPlanMapper">
  <resultMap id="BaseResultMap" type="com.sunbox.domain.InfoClusterOperationPlan">
    <id column="plan_id" jdbcType="VARCHAR" property="planId" />
    <result column="plan_name" jdbcType="VARCHAR" property="planName"/>
    <result column="cluster_id" jdbcType="VARCHAR" property="clusterId" />
    <result column="template_id" jdbcType="VARCHAR" property="templateId" />
    <result column="scaling_task_id" jdbcType="VARCHAR" property="scalingTaskId"/>
    <result column="op_task_id" jdbcType="VARCHAR" property="opTaskId"/>
    <result column="operation_type" jdbcType="VARCHAR" property="operationType" />
    <result column="createdby" jdbcType="VARCHAR" property="createdby" />
    <result column="created_time" jdbcType="TIMESTAMP" property="createdTime" />
    <result column="beg_time" jdbcType="TIMESTAMP" property="begTime"/>
    <result column="end_time" jdbcType="TIMESTAMP" property="endTime"/>
    <result column="state" jdbcType="INTEGER" property="state"/>
    <result column="percent" jdbcType="DOUBLE" property="percent"/>
  </resultMap>
  <sql id="Base_Column_List">
    plan_id,plan_name, cluster_id, template_id, operation_type, createdby, created_time,scaling_task_id,op_task_id,beg_time,end_time,
    state,percent
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from info_cluster_operation_plan
    where plan_id = #{planId,jdbcType=VARCHAR}
  </select>
  <select id="queryExistPlan" resultType="com.sunbox.domain.InfoClusterOperationPlan">
    select
    plan_id,cluster_id,template_id,operation_type,beg_time,end_time,createdby,created_time,scaling_task_id,op_task_id,
    beg_time,end_time,state,percent
    from info_cluster_operation_plan a
    where
      cluster_id = #{clusterId,jdbcType=VARCHAR}
      and template_id = #{templateId,jdbcType=VARCHAR}
      and operation_type = #{operationType,jdbcType=VARCHAR}
    limit 1
  </select>
  <select id="getPlanByScaleOutTaskId" resultType="com.sunbox.domain.InfoClusterOperationPlan">
    select
    <include refid="Base_Column_List" />
    from info_cluster_operation_plan
    where operation_type = 'scaleout' and scaling_task_id = #{scalingTaskId,jdbcType=VARCHAR}
    and cluster_id = #{clusterId,jdbcType=VARCHAR}
  </select>
  <select id="getPlanByScalingTaskId" resultType="com.sunbox.domain.InfoClusterOperationPlan">
    select
    <include refid="Base_Column_List" />
    from info_cluster_operation_plan
    where scaling_task_id = #{scalingTaskId,jdbcType=VARCHAR}
    and cluster_id = #{clusterId,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
  delete from info_cluster_operation_plan
  where plan_id = #{planId,jdbcType=VARCHAR}
</delete>
  <insert id="insert" parameterType="com.sunbox.domain.InfoClusterOperationPlan">
    insert into info_cluster_operation_plan (plan_id,plan_name,cluster_id, template_id,
      operation_type, createdby, created_time,scaling_task_id,op_task_id,beg_time,end_time,state,percent
      )
    values (#{planId,jdbcType=VARCHAR},#{planName,jdbcType=VARCHAR}, #{clusterId,jdbcType=VARCHAR}, #{templateId,jdbcType=VARCHAR},
      #{operationType,jdbcType=VARCHAR}, #{createdby,jdbcType=VARCHAR}, #{createdTime,jdbcType=TIMESTAMP}
      ,#{scalingTaskId,jdbcType=VARCHAR},#{opTaskId,jdbcType=VARCHAR},#{begTime,jdbcType=TIMESTAMP},#{endTime,jdbcType=TIMESTAMP},
            #{state,jdbcType=INTEGER},#{percent,jdbcType=DOUBLE}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.sunbox.domain.InfoClusterOperationPlan">
    insert into info_cluster_operation_plan
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="planId != null">
        plan_id,
      </if>
      <if test="planName != null">
        plan_name,
      </if>
      <if test="clusterId != null">
        cluster_id,
      </if>
      <if test="templateId != null">
        template_id,
      </if>
      <if test="operationType != null">
        operation_type,
      </if>
      <if test="createdby != null">
        createdby,
      </if>
      <if test="createdTime != null">
        created_time,
      </if>
      <if test="scalingTaskId != null">
        scaling_task_id,
      </if>
      <if test="opTaskId != null">
        op_task_id,
      </if>
      <if test="begTime != null">
        beg_time,
      </if>
      <if test="endTime != null">
        end_time,
      </if>
      <if test="state != null">
        state,
      </if>
      <if test="percent != null">
        percent,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="planId != null">
        #{planId,jdbcType=VARCHAR},
      </if>
      <if test="planName != null">
        #{planName,jdbcType=VARCHAR},
      </if>
      <if test="clusterId != null">
        #{clusterId,jdbcType=VARCHAR},
      </if>
      <if test="templateId != null">
        #{templateId,jdbcType=VARCHAR},
      </if>
      <if test="operationType != null">
        #{operationType,jdbcType=VARCHAR},
      </if>
      <if test="createdby != null">
        #{createdby,jdbcType=VARCHAR},
      </if>
      <if test="createdTime != null">
        #{createdTime,jdbcType=TIMESTAMP},
      </if>
      <if test="scalingTaskId != null">
        #{scalingTaskId,jdbcType=VARCHAR},
      </if>
      <if test="opTaskId != null">
        #{opTaskId,jdbcType=VARCHAR},
      </if>
      <if test="begTime != null">
        #{begTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null">
        #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="state != null">
        #{state,jdbcType=INTEGER},
      </if>
      <if test="percent != null">
        #{percent,jdbcType=DOUBLE},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.sunbox.domain.InfoClusterOperationPlan">
    update info_cluster_operation_plan
    <set>
      <if test="clusterId != null">
        cluster_id = #{clusterId,jdbcType=VARCHAR},
      </if>
      <if test="planName != null">
        plan_name = #{planName,jdbcType=VARCHAR},
      </if>
      <if test="templateId != null">
        template_id = #{templateId,jdbcType=VARCHAR},
      </if>
      <if test="operationType != null">
        operation_type = #{operationType,jdbcType=VARCHAR},
      </if>
      <if test="createdby != null">
        createdby = #{createdby,jdbcType=VARCHAR},
      </if>
      <if test="createdTime != null">
        created_time = #{createdTime,jdbcType=TIMESTAMP},
      </if>
      <if test="begTime != null">
        beg_time = #{begTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null">
        end_time = #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="scalingTaskId != null">
        scaling_task_id = #{scalingTaskId,jdbcType=TIMESTAMP},
      </if>
      <if test="opTaskId != null">
        op_task_id = #{opTaskId,jdbcType=TIMESTAMP},
      </if>
      <if test="begTime != null">
        beg_time = #{begTime,jdbcType=TIMESTAMP},
      </if>
      <if test="endTime != null">
        end_time = #{endTime,jdbcType=TIMESTAMP},
      </if>
      <if test="state != null">
        state = #{state,jdbcType=INTEGER},
      </if>
      <if test="percent != null">
       percent = #{percent,jdbcType=DOUBLE},
      </if>
    </set>
    where plan_id = #{planId,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.sunbox.domain.InfoClusterOperationPlan">
    update info_cluster_operation_plan
    set cluster_id = #{clusterId,jdbcType=VARCHAR},
        plan_name = #{planName,jdbcType=VARCHAR},
      template_id = #{templateId,jdbcType=VARCHAR},
      operation_type = #{operationType,jdbcType=VARCHAR},
      createdby = #{createdby,jdbcType=VARCHAR},
      created_time = #{createdTime,jdbcType=TIMESTAMP},
      scaling_task_id = #{scalingTaskId,jdbcType=TIMESTAMP},
      op_task_id = #{opTaskId,jdbcType=TIMESTAMP},
        beg_time = #{begTime,jdbcType=TIMESTAMP},
        end_time = #{endTime,jdbcType=TIMESTAMP},
        state = #{state,jdbcType=INTEGER},
        percent = #{percent,jdbcType=DOUBLE}
        where plan_id = #{planId,jdbcType=VARCHAR}
  </update>
  <update id="updatePlanStateAndPercent" parameterType="com.sunbox.domain.InfoClusterOperationPlan">
    update info_cluster_operation_plan
    <set>
    <if test="state != null">
      state = #{state,jdbcType=INTEGER},
    </if>
    <if test="percent != null">
      percent = #{percent,jdbcType=DOUBLE},
    </if>
    </set>
    where plan_id = #{planId,jdbcType=VARCHAR}
  </update>
  <update id="updatePlanName" parameterType="com.sunbox.domain.InfoClusterOperationPlan">
    update info_cluster_operation_plan
    <set>
      <if test="planName != null">
        plan_name = #{planName,jdbcType=VARCHAR},
      </if>
    </set>
    where plan_id = #{planId,jdbcType=VARCHAR}
  </update>
</mapper>