(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-acc27abc"],{"25a9":function(e,t,a){"use strict";a("8358")},3492:function(e,t,a){"use strict";a("8f8c")},"7ea2":function(e,t,a){"use strict";var l=a("751a");const c={list(e){return l["a"].post("/admin/api/queryclusterlist",e)},gettagKeyList(e){return l["a"].get("/admin/api/gettagkeylist",e)},getReleases(e){return l["a"].get("/admin/api/getreleases",e)},getReleaseApps(e){return l["a"].post("/admin/api/getreleaseapps",e)},getClassificationList(e){return l["a"].get("/admin/api/getclassificationlist",e)},getNetworkList(e){return l["a"].get("/admin/api/getnetworklist",e)},getSubnetList(e){return l["a"].get("/admin/api/getsubnetlist",e)},getPrimarySecurityGroupList(e){return l["a"].get("/admin/api/getprimarysecuritygrouplist",e)},getSubSecurityGroupList(e){return l["a"].get("/admin/api/getsubsecuritygrouplist",e)},getKeypairList(e){return l["a"].get("/admin/api/getkeypairlist",e)},getOsDiskTypeList(e){return l["a"].get("/admin/api/getosdisktypelist",e)},getVmskuList(e){return l["a"].get("/admin/api/getvmskulist",e)},createCluster(e){return l["a"].post("/admin/api/createcluster",e)},checkConnect(e){return l["a"].post("/admin/api/checkconnect",e)},checkClusterName(e){return l["a"].post("/admin/api/checkclustername",e)},getTagValueList(e){return l["a"].post("/admin/api/gettagvaluelist",e)},deleteCluster(e){return l["a"].post("/admin/api/deletecluster",e)}};t["a"]=c},8358:function(e,t,a){},"8f8c":function(e,t,a){},afd3:function(e,t,a){"use strict";a.r(t);a("14d9");var l=a("7a23"),c=a("a893"),r=a("6be2"),o=a("6605"),i=a("7ea2"),n=a("3ef4"),s=a("f6f2"),d=a("2bd7"),u=a("de33");const b=e=>(Object(l["pushScopeId"])("data-v-760ca988"),e=e(),Object(l["popScopeId"])(),e),p={class:"cluster-list page-css list-css"},O={class:"functions-row"},j={class:"full-container"},m=["onClick"],g={class:"cluster-name"},f={class:"cluster-id"},N={class:"cluster-tags"},V={key:0,class:"cluster-tag-item single-row"},v={class:"popper-tag"},h={class:"cluster-tags"},w={class:"cluster-tag-item"},k={class:"master-ips"},y={key:0,class:"master-ip-item single-row"},C={class:"dialog-footer"},x={style:{display:"flex","align-items":"center"}},E=b(()=>Object(l["createElementVNode"])("div",{style:{"margin-left":"10px"}},"点击确定后将删除集群及该集群下的所有资源，且不可逆，确定要销毁以下集群吗？",-1)),_={key:0,style:{"margin-left":"35px","padding-top":"20px"}},T={class:"dialog-footer"},I={class:"task-info"},D={class:"task-name"},S={class:"task-id"},B={class:"cluster-info"},L={class:"cluster-name"},R={class:"cluster-id"},z={class:"dialog-footer"};var F={__name:"index",setup(e){const t=Object(l["ref"])(!1),a=Object(o["d"])(),b=[{label:"全部",value:""},{label:"待创建",value:0},{label:"创建中",value:1},{label:"已创建",value:2},{label:"销毁中",value:-1},{label:"已销毁",value:-2}],F=Object(l["ref"])([{type:"combo-box",key:"clusterName",props:{},selOptionType:"",options:[{type:"el-input",label:"集群名称",rules:[],key:"clusterName",props:{placeholder:"请输入集群名称",clearable:!0}},{type:"el-input",label:"集群ID",rules:[],key:"clusterId",props:{placeholder:"请输入集群ID",clearable:!0}}]},{type:"RemoteSelect",label:"状态",rules:[],key:"state",props:{placeholder:"请选择状态",clearable:!0,options:b}},{type:"el-cascader",label:"集群标签",rules:[],key:"label",props:{placeholder:"请选择集群标签",clearable:!0,props:{lazy:!0,lazyLoad(e,t){const{level:a}=e;console.log(e),0==a?i["a"].gettagKeyList().then(e=>{if(1==e.result){let a=e.data||[],l=[{label:"全部",value:"",leaf:!0}];for(let e=0;e<a.length;e++){let t=a[e];l.push({value:t.dictValue,label:t.dictName,leaf:!1})}t(l)}else n["a"].error(e.errorMsg),t([])}):i["a"].getTagValueList({tagKey:e.value}).then(e=>{if(1==e.result){let a=e.data,l=[];for(let e=0;e<a.length;e++){let t=a[e];l.push({value:t.tagVal,label:t.tagVal,leaf:!0})}t(l)}else n["a"].error(e.message),t([])})}}}}]);function M(e){return i["a"].list(e)}function P(){a.push("/clustercreate")}function A(e){let t=b.find(t=>t.value===e)||{};return t.label||""}const G=Object(l["ref"])(null);function K(e){let t=e.label||[],a={clusterId:e.clusterId,clusterName:e.clusterName,state:e.state,pageIndex:e.pageIndex,pageSize:e.pageSize};2==t.length&&(a.clusterTag=t[0],a.tagValue=t[1]),G.value.filterEvent(a)}function U(e){K(e)}let J=Object(l["ref"])(!1),q=null;const H=Object(l["ref"])([]);function Q(e,a=!0){a&&(t.value=!0),u["a"].list({pageIndex:1,pageSize:50,clusterId:e.clusterId}).then(t=>{if(1==t.result){if(H.value=t.data,a&&(J.value=!0),J.value){let t=!0;for(let e=0;e<H.value.length;e++)if("-"==H.value[e].endTime){t=!1;break}t||(q&&clearTimeout(q),q=setTimeout(()=>{Q(e,!1)},1e4))}}else n["a"].error(t.errorMsg)}).finally(()=>{t.value=!1})}function W(){console.log("taskListClosed"),q&&(clearTimeout(q),q=null)}let X=Object(l["ref"])(!1),Y=null;const Z=Object(l["ref"])({});function $(e,a=!0){a&&(t.value=!0),u["a"].getjobdetail({planId:e.planId}).then(t=>{if(1==t.result){if(Z.value=t.data,a&&(X.value=!0),X.value){let t=Z.value.activityInfos||[],a=!0;for(let e=0;e<t.length;e++)if("-"==t[e].endTime){a=!1;break}a||(Y&&clearTimeout(Y),Y=setTimeout(()=>{$(e,!1)},1e4))}}else n["a"].error(t.errorMsg)}).finally(()=>{t.value=!1})}function ee(){console.log("taskListClosed"),Y&&(clearTimeout(Y),Y=null)}let te=Object(l["ref"])(!1);const ae=Object(l["ref"])({});function le(e){ae.value=e,ae.value.check=!1,te.value=!0}function ce(){"1"!=ae.value.deleteProtected||0!=ae.value.check?(t.value=!0,i["a"].deleteCluster({clusterId:ae.value.clusterId,relieveDeleteProtected:ae.value.check}).then(e=>{1==e.result?(te.value=!1,n["a"].success("集群开始销毁中..."),K()):n["a"].error(e.errorMsg)}).finally(()=>{t.value=!1})):n["a"].error('集群关闭保护中，请先勾选"解除关闭保护"再销毁')}function re(e){return e.split(",")}function oe(e){if("2"!=e.state)return void n["a"].warning("集群已销毁或还未创建成功！");let t="http://"+e.ambariIp+":8080";window.open(t)}return(e,a)=>{const o=Object(l["resolveComponent"])("el-button"),i=Object(l["resolveComponent"])("el-table-column"),n=Object(l["resolveComponent"])("el-icon"),u=Object(l["resolveComponent"])("el-popover"),b=Object(l["resolveComponent"])("el-table"),q=Object(l["resolveComponent"])("el-dialog"),Y=Object(l["resolveComponent"])("el-checkbox"),ie=Object(l["resolveDirective"])("loading");return Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",p,[Object(l["createVNode"])(Object(l["unref"])(c["a"]),{filters:F.value,onOnSearch:K,onOnReset:U},null,8,["filters"]),Object(l["createElementVNode"])("div",O,[Object(l["createVNode"])(o,{type:"primary",onClick:P},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("创建集群")]),_:1})]),Object(l["createElementVNode"])("div",j,[Object(l["createVNode"])(Object(l["unref"])(r["a"]),{ref_key:"TabelContainer",ref:G,listApiFunction:M},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(b,{height:e.data.tableHeight,data:e.data.tableData,stripe:"","header-row-class-name":"theader",style:{width:"100%"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(i,{prop:"clusterName",label:"名称 / ID","min-width":"120"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",{class:"cluster-info",onClick:t=>oe(e.row)},[Object(l["createElementVNode"])("div",g,Object(l["toDisplayString"])(e.row.clusterName),1),Object(l["createElementVNode"])("div",f,Object(l["toDisplayString"])(e.row.clusterId),1)],8,m)]),_:1}),Object(l["createVNode"])(i,{prop:"state",label:"状态",width:"100"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(o,{type:"primary",text:"",onClick:t=>Q(e.row)},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(A(e.row.state)),1),1==e.row.state||-1==e.row.state?(Object(l["openBlock"])(),Object(l["createBlock"])(n,{key:0,style:{"margin-left":"6px"},class:"is-loading",size:"18"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(Object(l["unref"])(s["i"]))]),_:1})):Object(l["createCommentVNode"])("",!0)]),_:2},1032,["onClick"])]),_:1}),Object(l["createVNode"])(i,{prop:"clusterTag",label:"集群标签","min-width":"120"},{default:Object(l["withCtx"])(e=>[Object(l["createVNode"])(u,{trigger:"hover",placement:"left",width:300,"popper-class":"popper-tag"},{reference:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",N,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.row.clusterTag,(e,t)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[t<2?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",V,Object(l["toDisplayString"])(e.tagGroup)+"："+Object(l["toDisplayString"])(e.tagVal),1)):Object(l["createCommentVNode"])("",!0)],64))),256))])]),default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",v,[Object(l["createElementVNode"])("div",h,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.row.clusterTag,(e,t)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",w,Object(l["toDisplayString"])(e.tagGroup)+"："+Object(l["toDisplayString"])(e.tagVal),1))),256))])])]),_:2},1024)]),_:1}),Object(l["createVNode"])(i,{prop:"masterIps",label:"Ambari / Master IP","min-width":"100"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(o,{type:"primary",text:"",onClick:t=>oe(e.row)},{default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.row.ambariIp),1)]),_:2},1032,["onClick"])]),Object(l["createElementVNode"])("div",k,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(re(e.row.masterIps),(t,a)=>(Object(l["openBlock"])(),Object(l["createElementBlock"])(l["Fragment"],null,[e.row.ambariIp!=t?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",y,Object(l["toDisplayString"])(t),1)):Object(l["createCommentVNode"])("",!0)],64))),256))])]),_:1}),Object(l["createVNode"])(i,{prop:"masterNodeNum",label:"Ambari / Master 节点数",width:"130"},{default:Object(l["withCtx"])(e=>[Object(l["createTextVNode"])(Object(l["toDisplayString"])(parseInt(e.row.masterNodeNum||0)+parseInt(e.row.ambariNodeNum||1)),1)]),_:1}),Object(l["createVNode"])(i,{prop:"coreNodeNum",label:"Core 节点数",width:"70"}),Object(l["createVNode"])(i,{prop:"taskNodeNum",label:"Task 节点数",width:"70"}),Object(l["createVNode"])(i,{prop:"serviceNum",label:"服务数",width:"70"}),Object(l["createVNode"])(i,{prop:"createdTime",label:"创建时间",width:"110"}),Object(l["createVNode"])(i,{fixed:"right",label:"管理",width:"180"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(o,{type:"primary",text:""},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("资源")]),_:1}),"-2"!=e.row.state&&"-1"!=e.row.state?(Object(l["openBlock"])(),Object(l["createBlock"])(o,{key:0,type:"primary",text:"",onClick:t=>le(e.row)},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("销毁")]),_:2},1032,["onClick"])):Object(l["createCommentVNode"])("",!0),Object(l["createVNode"])(o,{type:"primary",text:""},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("复制")]),_:1}),Object(l["createVNode"])(o,{type:"primary",text:""},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("导出")]),_:1})])]),_:1})]),_:2},1032,["height","data"])]),_:1},512)]),Object(l["createVNode"])(q,{class:"center-dialog",modelValue:Object(l["unref"])(X),"onUpdate:modelValue":a[1]||(a[1]=e=>Object(l["isRef"])(X)?X.value=e:X=e),title:"任务详情",width:"900","destroy-on-close":"",onClosed:ee},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",C,[Object(l["createVNode"])(o,{onClick:a[0]||(a[0]=e=>Object(l["isRef"])(X)?X.value=!1:X=!1)},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("关闭")]),_:1})])]),default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(Object(l["unref"])(d["a"]),{detailData:Z.value},null,8,["detailData"])])]),_:1},8,["modelValue"]),Object(l["createVNode"])(q,{class:"center-dialog",modelValue:Object(l["unref"])(te),"onUpdate:modelValue":a[4]||(a[4]=e=>Object(l["isRef"])(te)?te.value=e:te=e),title:"销毁集群",width:"600","destroy-on-close":""},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",T,[Object(l["createVNode"])(o,{onClick:a[3]||(a[3]=e=>Object(l["isRef"])(te)?te.value=!1:te=!1)},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("关闭")]),_:1}),Object(l["createVNode"])(o,{type:"danger",onClick:ce},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("确定")]),_:1})])]),default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("div",x,[Object(l["createVNode"])(n,{size:"30",color:"#e6a23c"},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(Object(l["unref"])(s["p"]))]),_:1}),E]),"1"==ae.value.deleteProtected?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",_,[Object(l["createVNode"])(Y,{modelValue:ae.value.check,"onUpdate:modelValue":a[2]||(a[2]=e=>ae.value.check=e)},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("解除关闭保护")]),_:1},8,["modelValue"])])):Object(l["createCommentVNode"])("",!0)])]),_:1},8,["modelValue"]),Object(l["createVNode"])(q,{class:"task-list-dialog center-dialog",modelValue:Object(l["unref"])(J),"onUpdate:modelValue":a[6]||(a[6]=e=>Object(l["isRef"])(J)?J.value=e:J=e),title:"任务列表",width:"900","destroy-on-close":"",onClosed:W},{footer:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",z,[Object(l["createVNode"])(o,{onClick:a[5]||(a[5]=e=>Object(l["isRef"])(J)?J.value=!1:J=!1)},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("关闭")]),_:1})])]),default:Object(l["withCtx"])(()=>[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(b,{data:H.value,stripe:"","header-row-class-name":"theader",style:{"max-height":"60vh"}},{default:Object(l["withCtx"])(()=>[Object(l["createVNode"])(i,{prop:"jobName",label:"任务名称/ID","min-width":"120"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",I,[Object(l["createElementVNode"])("div",D,Object(l["toDisplayString"])(e.row.jobName),1),Object(l["createElementVNode"])("div",S,Object(l["toDisplayString"])(e.row.planId),1)])]),_:1}),Object(l["createVNode"])(i,{prop:"clusterName",label:"集群名称/ID","min-width":"120"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",B,[Object(l["createElementVNode"])("div",L,Object(l["toDisplayString"])(e.row.clusterName),1),Object(l["createElementVNode"])("div",R,Object(l["toDisplayString"])(e.row.clusterId),1)])]),_:1}),Object(l["createVNode"])(i,{prop:"state",label:"状态",width:"100"}),Object(l["createVNode"])(i,{prop:"begTime",label:"开始时间",width:"110"}),Object(l["createVNode"])(i,{prop:"endTime",label:"结束时间",width:"110"}),Object(l["createVNode"])(i,{fixed:"right",label:"管理",width:"100"},{default:Object(l["withCtx"])(e=>[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(o,{type:"primary",text:"",onClick:t=>$(e.row)},{default:Object(l["withCtx"])(()=>[Object(l["createTextVNode"])("任务详情")]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])])]),_:1},8,["modelValue"])])),[[ie,t.value]])}}},M=(a("25a9"),a("3492"),a("d959")),P=a.n(M);const A=P()(F,[["__scopeId","data-v-760ca988"]]);t["default"]=A}}]);
//# sourceMappingURL=chunk-acc27abc.94e946c5.js.map