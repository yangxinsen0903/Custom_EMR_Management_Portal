<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sunbox.sdptask.mapper.ConfClusterMapper">
    <resultMap id="BaseResultMap" type="com.sunbox.domain.ConfCluster">
        <id column="cluster_id" jdbcType="VARCHAR" property="clusterId"/>
        <result column="cluster_name" jdbcType="VARCHAR" property="clusterName"/>
        <result column="cluster_release_ver" jdbcType="VARCHAR" property="clusterReleaseVer"/>
        <result column="region" jdbcType="VARCHAR" property="region"/>
        <result column="scene" jdbcType="VARCHAR" property="scene"/>
        <result column="zone" jdbcType="VARCHAR" property="zone"/>
        <result column="zone_name" jdbcType="VARCHAR" property="zoneName"/>
        <result column="vnet" jdbcType="VARCHAR" property="vnet"/>
        <result column="subnet" jdbcType="VARCHAR" property="subnet"/>
        <result column="config_type" jdbcType="VARCHAR" property="configType"/>
        <result column="master_security_group" jdbcType="VARCHAR" property="masterSecurityGroup"/>
        <result column="slave_security_group" jdbcType="VARCHAR" property="slaveSecurityGroup"/>
        <result column="log_path" jdbcType="VARCHAR" property="logPath"/>
        <result column="keypair_id" jdbcType="VARCHAR" property="keypairId"/>
        <result column="delete_protected" jdbcType="VARCHAR" property="deleteProtected"/>
        <result column="instance_collection_type" jdbcType="VARCHAR" property="instanceCollectionType"/>
        <result column="publicIp_available" jdbcType="VARCHAR" property="publicipAvailable"/>
        <result column="ambari_dburl" jdbcType="VARCHAR" property="ambariDburl"/>
        <result column="ambari_port" jdbcType="VARCHAR" property="ambariPort"/>
        <result column="ambari_database" jdbcType="VARCHAR" property="ambariDatabase"/>
        <result column="ambari_db_autocreate" jdbcType="INTEGER" property="ambariDbAutocreate"/>
        <result column="hive_metadata_dburl" jdbcType="VARCHAR" property="hiveMetadataDburl"/>
        <result column="hive_metadata_port" jdbcType="VARCHAR" property="hiveMetadataPort"/>
        <result column="hive_metadata_database" jdbcType="VARCHAR" property="hiveMetadataDatabase"/>
        <result column="ambari_acount" jdbcType="VARCHAR" property="ambariAcount"/>
        <result column="is_embed_ambaridb" jdbcType="INTEGER" property="isEmbedAmbariDb"/>
        <result column="is_ha" jdbcType="INTEGER" property="isHa"/>
        <result column="src_cluster_id" jdbcType="VARCHAR" property="srcClusterId"/>
        <result column="state" jdbcType="INTEGER" property="state"/>
        <result column="createdby" jdbcType="VARCHAR" property="createdby"/>
        <result column="created_time" jdbcType="TIMESTAMP" property="createdTime"/>
        <result column="modifiedby" jdbcType="VARCHAR" property="modifiedby"/>
        <result column="modified_time" jdbcType="TIMESTAMP" property="modifiedTime"/>
        <result column="vm_mi" jdbcType="VARCHAR" property="vmMI"/>
        <result column="log_mi" jdbcType="VARCHAR" property="logMI"/>
        <result column="vm_mi_tenant_id" jdbcType="VARCHAR" property="vmMITenantId"/>
        <result column="vm_mi_client_id" jdbcType="VARCHAR" property="vmMIClientId"/>
        <result column="log_mi_tenant_id" jdbcType="VARCHAR" property="logMITenantId"/>
        <result column="log_mi_client_id" jdbcType="VARCHAR" property="logMIClientId"/>
        <result column="enable_ganglia" jdbcType="INTEGER" property="enableGanglia"/>
        <result column="creation_sub_state" jdbcType="VARCHAR" property="creationSubState"/>
        <result column="is_parallel_scale" jdbcType="INTEGER" property="isParallelScale"/>
    </resultMap>
    <sql id="Base_Column_List">
        cluster_id, cluster_name, cluster_release_ver, region, scene, zone, zone_name, vnet, subnet, config_type,
        master_security_group, slave_security_group, log_path, keypair_id, delete_protected,
        instance_collection_type, publicIp_available, ambari_dburl, ambari_port, ambari_database,ambari_db_autocreate,
        hive_metadata_dburl, hive_metadata_port, hive_metadata_database, ambari_acount, is_ha, vm_mi, log_mi,
        vm_mi_tenant_id, vm_mi_client_id, log_mi_tenant_id, log_mi_client_id,
        src_cluster_id,state, createdby, created_time, modifiedby, modified_time,is_embed_ambaridb,enable_ganglia,
        creation_sub_state,is_parallel_scale
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from conf_cluster
        where cluster_id = #{clusterId,jdbcType=VARCHAR}
    </select>

    <select id="selectClusterNameByPrimaryKey" parameterType="java.lang.String" resultType="java.lang.String">
        select cluster_name
        from conf_cluster
        where cluster_id = #{clusterId,jdbcType=VARCHAR}
    </select>

    <select id="selectByClusterName" parameterType="java.lang.String" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from conf_cluster
        where cluster_name = #{clusterName,jdbcType=VARCHAR}
    </select>

    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        delete from conf_cluster
        where cluster_id = #{clusterId,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.sunbox.domain.ConfCluster">
        insert into conf_cluster (cluster_id, cluster_name, cluster_release_ver,
        region, scene, zone, zone_name, vnet,
        subnet, config_type, master_security_group,
        slave_security_group, log_path, keypair_id,
        delete_protected, instance_collection_type,
        publicIp_available, ambari_dburl, ambari_port, ambari_database, hive_metadata_dburl,
        hive_metadata_port, hive_metadata_database, ambari_acount, is_ha,src_cluster_id, state,
        createdby, created_time, modifiedby,
        modified_time,is_embed_ambaridb,enable_ganglia)
        values (#{clusterId,jdbcType=VARCHAR}, #{clusterName,jdbcType=VARCHAR}, #{clusterReleaseVer,jdbcType=VARCHAR},
        #{region,jdbcType=VARCHAR}, #{scene,jdbcType=VARCHAR}, #{zone,jdbcType=VARCHAR}, #{zoneName,jdbcType=VARCHAR},
        #{vnet,jdbcType=VARCHAR},
        #{subnet,jdbcType=VARCHAR}, #{configType,jdbcType=VARCHAR}, #{masterSecurityGroup,jdbcType=VARCHAR},
        #{slaveSecurityGroup,jdbcType=VARCHAR}, #{logPath,jdbcType=VARCHAR}, #{keypairId,jdbcType=VARCHAR},
        #{deleteProtected,jdbcType=VARCHAR}, #{instanceCollectionType,jdbcType=VARCHAR},
        #{publicipAvailable,jdbcType=VARCHAR}, #{ambariDburl,jdbcType=VARCHAR}, #{ambariPort,jdbcType=VARCHAR},
        #{ambariDatabase,jdbcType=VARCHAR}, #{hiveMetadataDburl,jdbcType=VARCHAR},
        #{hiveMetadataPort,jdbcType=VARCHAR}, #{hiveMetadataDatabase,jdbcType=VARCHAR},
        #{ambariAcount,jdbcType=VARCHAR},
        #{isHa,jdbcType=INTEGER}, #{srcClusterId,jdbcType=VARCHAR},#{state,jdbcType=INTEGER},
        #{createdby,jdbcType=VARCHAR}, #{createdTime,jdbcType=TIMESTAMP}, #{modifiedby,jdbcType=VARCHAR},
        #{modifiedTime,jdbcType=TIMESTAMP},#{isEmbedAmbariDb,jdbcType=INTEGER}, #{enableGanglia,jdbcType=INTEGER})
    </insert>
    <insert id="insertSelective" parameterType="com.sunbox.domain.ConfCluster">
        insert into conf_cluster
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="clusterId != null">
                cluster_id,
            </if>
            <if test="clusterName != null">
                cluster_name,
            </if>
            <if test="clusterReleaseVer != null">
                cluster_release_ver,
            </if>
            <if test="region != null">
                region,
            </if>
            <if test="scene != null">
                scene,
            </if>
            <if test="zone != null">
                zone,
            </if>
            <if test="zoneName != null">
                zone_name,
            </if>
            <if test="vnet != null">
                vnet,
            </if>
            <if test="subnet != null">
                subnet,
            </if>
            <if test="configType != null">
                config_type,
            </if>
            <if test="masterSecurityGroup != null">
                master_security_group,
            </if>
            <if test="slaveSecurityGroup != null">
                slave_security_group,
            </if>
            <if test="logPath != null">
                log_path,
            </if>
            <if test="keypairId != null">
                keypair_id,
            </if>
            <if test="deleteProtected != null">
                delete_protected,
            </if>
            <if test="instanceCollectionType != null">
                instance_collection_type,
            </if>
            <if test="publicipAvailable != null">
                publicIp_available,
            </if>
            <if test="ambariDburl != null">
                ambari_dburl,
            </if>
            <if test="ambariPort != null and ambariPort != ''">
                ambari_port,
            </if>
            <if test="ambariDatabase != null and ambariDatabase != ''">
                ambari_database,
            </if>
            <if test="hiveMetadataDburl != null">
                hive_metadata_dburl,
            </if>
            <if test="hiveMetadataPort != null">
                hive_metadata_port,
            </if>
            <if test="hiveMetadataDatabase != null">
                hive_metadata_database,
            </if>
            <if test="ambariAcount != null">
                ambari_acount,
            </if>
            <if test="isHa != null">
                is_ha,
            </if>
            <if test="srcClusterId != null">
                src_cluster_id,
            </if>
            <if test="state != null">
                state,
            </if>
            <if test="createdby != null">
                createdby,
            </if>
            <if test="createdTime != null">
                created_time,
            </if>
            <if test="modifiedby != null">
                modifiedby,
            </if>
            <if test="modifiedTime != null">
                modified_time,
            </if>
            <if test="isEmbedAmbariDb != null">
                is_embed_ambaridb,
            </if>
            <if test="enableGanglia != null">
                enable_ganglia
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="clusterId != null">
                #{clusterId,jdbcType=VARCHAR},
            </if>
            <if test="clusterName != null">
                #{clusterName,jdbcType=VARCHAR},
            </if>
            <if test="clusterReleaseVer != null">
                #{clusterReleaseVer,jdbcType=VARCHAR},
            </if>
            <if test="region != null">
                #{region,jdbcType=VARCHAR},
            </if>
            <if test="scene != null">
                #{scene,jdbcType=VARCHAR},
            </if>
            <if test="zone != null">
                #{zone,jdbcType=VARCHAR},
            </if>
            <if test="zoneName != null">
                #{zoneName,jdbcType=VARCHAR},
            </if>
            <if test="vnet != null">
                #{vnet,jdbcType=VARCHAR},
            </if>
            <if test="subnet != null">
                #{subnet,jdbcType=VARCHAR},
            </if>
            <if test="configType != null">
                #{configType,jdbcType=VARCHAR},
            </if>
            <if test="masterSecurityGroup != null">
                #{masterSecurityGroup,jdbcType=VARCHAR},
            </if>
            <if test="slaveSecurityGroup != null">
                #{slaveSecurityGroup,jdbcType=VARCHAR},
            </if>
            <if test="logPath != null">
                #{logPath,jdbcType=VARCHAR},
            </if>
            <if test="keypairId != null">
                #{keypairId,jdbcType=VARCHAR},
            </if>
            <if test="deleteProtected != null">
                #{deleteProtected,jdbcType=VARCHAR},
            </if>
            <if test="instanceCollectionType != null">
                #{instanceCollectionType,jdbcType=VARCHAR},
            </if>
            <if test="publicipAvailable != null">
                #{publicipAvailable,jdbcType=VARCHAR},
            </if>
            <if test="ambariDburl != null">
                #{ambariDburl,jdbcType=VARCHAR},
            </if>
            <if test="ambariPort != null and ambariPort != ''">
                #{ambariPort,jdbcType=VARCHAR},
            </if>
            <if test="ambariDatabase != null and ambariDatabase != ''">
                #{ambariDatabase,jdbcType=VARCHAR},
            </if>
            <if test="hiveMetadataDburl != null">
                #{hiveMetadataDburl,jdbcType=VARCHAR},
            </if>
            <if test="hiveMetadataPort != null">
                #{hiveMetadataPort,jdbcType=VARCHAR},
            </if>
            <if test="hiveMetadataDatabase != null">
                #{hiveMetadataDatabase,jdbcType=VARCHAR},
            </if>
            <if test="ambariAcount != null">
                #{ambariAcount,jdbcType=VARCHAR},
            </if>
            <if test="isHa != null">
                #{isHa,jdbcType=INTEGER},
            </if>
            <if test="srcClusterId != null">
                #{srcClusterId,jdbcType=VARCHAR},
            </if>
            <if test="state != null">
                #{state,jdbcType=INTEGER},
            </if>
            <if test="createdby != null">
                #{createdby,jdbcType=VARCHAR},
            </if>
            <if test="createdTime != null">
                #{createdTime,jdbcType=TIMESTAMP},
            </if>
            <if test="modifiedby != null">
                #{modifiedby,jdbcType=VARCHAR},
            </if>
            <if test="modifiedTime != null">
                #{modifiedTime,jdbcType=TIMESTAMP},
            </if>
            <if test="isEmbedAmbariDb != null">
                #{isEmbedAmbariDb,jdbcType=INTEGER},
            </if>
            <if test="enableGanglia != null">
                #{enableGanglia,jdbcType=INTEGER}
            </if>
        </trim>
    </insert>

    <update id="updateClusterState">
        update conf_cluster
        set state = #{state}
        where cluster_id = #{clusterId}
    </update>

    <update id="updateByPrimaryKeySelective" parameterType="com.sunbox.domain.ConfCluster">
        update conf_cluster
        <set>
            <if test="clusterName != null">
                cluster_name = #{clusterName,jdbcType=VARCHAR},
            </if>
            <if test="clusterReleaseVer != null">
                cluster_release_ver = #{clusterReleaseVer,jdbcType=VARCHAR},
            </if>
            <if test="region != null">
                region = #{region,jdbcType=VARCHAR},
            </if>
            <if test="scene != null">
                scene = #{scene,jdbcType=VARCHAR},
            </if>
            <if test="zone != null">
                zone = #{zone,jdbcType=VARCHAR},
            </if>
            <if test="zoneName != null">
                zone_name = #{zoneName,jdbcType=VARCHAR},
            </if>
            <if test="vnet != null">
                vnet = #{vnet,jdbcType=VARCHAR},
            </if>
            <if test="subnet != null">
                subnet = #{subnet,jdbcType=VARCHAR},
            </if>
            <if test="configType != null">
                config_type = #{configType,jdbcType=VARCHAR},
            </if>
            <if test="masterSecurityGroup != null">
                master_security_group = #{masterSecurityGroup,jdbcType=VARCHAR},
            </if>
            <if test="slaveSecurityGroup != null">
                slave_security_group = #{slaveSecurityGroup,jdbcType=VARCHAR},
            </if>
            <if test="logPath != null">
                log_path = #{logPath,jdbcType=VARCHAR},
            </if>
            <if test="keypairId != null">
                keypair_id = #{keypairId,jdbcType=VARCHAR},
            </if>
            <if test="deleteProtected != null">
                delete_protected = #{deleteProtected,jdbcType=VARCHAR},
            </if>
            <if test="instanceCollectionType != null">
                instance_collection_type = #{instanceCollectionType,jdbcType=VARCHAR},
            </if>
            <if test="publicipAvailable != null">
                publicIp_available = #{publicipAvailable,jdbcType=VARCHAR},
            </if>
            <if test="ambariDburl != null">
                ambari_dburl = #{ambariDburl,jdbcType=VARCHAR},
            </if>
            <if test="ambariPort != null and ambariPort != ''">
                ambari_port = #{ambariPort,jdbcType=VARCHAR},
            </if>
            <if test="ambariDatabase != null and ambariDatabase != ''">
                ambari_database = #{ambariDatabase,jdbcType=VARCHAR},
            </if>
            <if test="hiveMetadataDburl != null">
                hive_metadata_dburl = #{hiveMetadataDburl,jdbcType=VARCHAR},
            </if>
            <if test="hiveMetadataPort != null">
                hive_metadata_port = #{hiveMetadataPort,jdbcType=VARCHAR},
            </if>
            <if test="hiveMetadataDatabase != null">
                hive_metadata_database = #{hiveMetadataDatabase,jdbcType=VARCHAR},
            </if>
            <if test="ambariAcount != null">
                ambari_acount = #{ambariAcount,jdbcType=VARCHAR},
            </if>
            <if test="isHa != null">
                is_ha = #{isHa,jdbcType=INTEGER},
            </if>
            <if test="srcClusterId != null">
                src_cluster_id= #{srcClusterId,jdbcType=VARCHAR},
            </if>
            <if test="state != null">
                state = #{state,jdbcType=INTEGER},
            </if>
            <if test="createdby != null">
                createdby = #{createdby,jdbcType=VARCHAR},
            </if>
            <if test="createdTime != null">
                created_time = #{createdTime,jdbcType=TIMESTAMP},
            </if>
            <if test="modifiedby != null">
                modifiedby = #{modifiedby,jdbcType=VARCHAR},
            </if>
            <if test="modifiedTime != null">
                modified_time = #{modifiedTime,jdbcType=TIMESTAMP},
            </if>
            <if test="isEmbedAmbariDb != null">
                is_embed_ambaridb = #{isEmbedAmbariDb,jdbcType=INTEGER},
            </if>
            <if test="enableGanglia != null">
                enable_ganglia = #{enableGanglia,jdbcType=INTEGER}
            </if>
            <if test="creationSubState != null">
                creation_sub_state = #{creationSubState,jdbcType=VARCHAR}
            </if>
        </set>
        where cluster_id = #{clusterId,jdbcType=VARCHAR}
    </update>
    <update id="updateCreationSubStateByClusterId">
        update conf_cluster
        set creation_sub_state = #{creationSubState}
        where cluster_id = #{clusterId}
    </update>
    <update id="updateCreationSubStateByClusterIdAndCreationSubStateIsNotNull">
        update conf_cluster
        set creation_sub_state = #{creationSubState}
        where cluster_id = #{clusterId}
        and creation_sub_state is not null
    </update>

    <update id="updateByPrimaryKey" parameterType="com.sunbox.domain.ConfCluster">
        update conf_cluster
        set cluster_name = #{clusterName,jdbcType=VARCHAR},
        cluster_release_ver = #{clusterReleaseVer,jdbcType=VARCHAR},
        region = #{region,jdbcType=VARCHAR},
        scene = #{scene,jdbcType=VARCHAR},
        zone = #{zone,jdbcType=VARCHAR},
        zone_name = #{zoneName,jdbcType=VARCHAR},
        vnet = #{vnet,jdbcType=VARCHAR},
        subnet = #{subnet,jdbcType=VARCHAR},
        config_type = #{configType,jdbcType=VARCHAR},
        master_security_group = #{masterSecurityGroup,jdbcType=VARCHAR},
        slave_security_group = #{slaveSecurityGroup,jdbcType=VARCHAR},
        log_path = #{logPath,jdbcType=VARCHAR},
        keypair_id = #{keypairId,jdbcType=VARCHAR},
        delete_protected = #{deleteProtected,jdbcType=VARCHAR},
        instance_collection_type = #{instanceCollectionType,jdbcType=VARCHAR},
        publicIp_available = #{publicipAvailable,jdbcType=VARCHAR},
        ambari_dburl = #{ambariDburl,jdbcType=VARCHAR},
        ambari_port = #{ambariPort,jdbcType=VARCHAR},
        ambari_database = #{ambariDatabase,jdbcType=VARCHAR},
        hive_metadata_dburl = #{hiveMetadataDburl,jdbcType=VARCHAR},
        hive_metadata_port = #{hiveMetadataPort,jdbcType=VARCHAR},
        hive_metadata_database = #{hiveMetadataDatabase,jdbcType=VARCHAR},
        ambari_acount = #{ambariAcount,jdbcType=VARCHAR},
        is_ha = #{isHa,jdbcType=INTEGER},
        src_cluster_id= #{srcClusterId,jdbcType=VARCHAR},
        state = #{state,jdbcType=INTEGER},
        createdby = #{createdby,jdbcType=VARCHAR},
        created_time = #{createdTime,jdbcType=TIMESTAMP},
        modifiedby = #{modifiedby,jdbcType=VARCHAR},
        modified_time = #{modifiedTime,jdbcType=TIMESTAMP},
        is_embed_ambaridb = #{isEmbedAmbariDb,jdbcType=INTEGER},
        enable_ganglia = #{enableGanglia,jdbcType=INTEGER}
        where cluster_id = #{clusterId,jdbcType=VARCHAR}
    </update>
    <update id="updateBatchClusterState">
        update conf_cluster
        set state = #{state},
        set modified_time = now(),
        set modifiedby = 'system'
        where cluster_id in
        <foreach collection="clusterIds"  item="clusterId" separator="," open="(" close=")">
            #{clusterId,jdbcType=VARCHAR}
        </foreach>
    </update>

    <select id="selectByClusterIdAndStateAndCreationSubState" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from conf_cluster
        where cluster_id = #{clusterId,jdbcType=VARCHAR}
        and state = #{state,jdbcType=INTEGER}
        and creation_sub_state = #{creationSubState,jdbcType=VARCHAR}
    </select>
    <select id="selectByState" resultType="com.sunbox.domain.ConfCluster">
        select
        <include refid="Base_Column_List"/>
        from conf_cluster
        where
        state = #{state,jdbcType=INTEGER}
        <if test="region != null and region != ''">
            region = #{region,jdbcType=VARCHAR},
        </if>

    </select>
</mapper>